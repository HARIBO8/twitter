{% extends 'base.html' %}

{% block title %}{{ profile_user.username }}ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«{% endblock %}

{% block content %}
  <h2>ğŸ‘¤ {{ profile_user.username }} ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h2>

  {% if profile.avatar %}
    <img src="{{ profile.avatar.url }}" width="100" alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ">
  {% endif %}

  <p><strong>è‡ªå·±ç´¹ä»‹ï¼š</strong> {{ profile.bio }}</p>

  <hr>

{% if profile_user != request.user %}
  <button id="follow-btn" data-user-id="{{ profile_user.id }}">
    ãƒ•ã‚©ãƒ­ãƒ¼
  </button>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function () {
  const btn = document.getElementById('follow-btn');
  if (btn) {
    btn.addEventListener('click', () => {
      const userId = btn.dataset.userId;
      fetch(`/follow-toggle/${userId}/`, {
        method: 'POST',
        headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'Accept': 'application/json',
        }
      })
      .then(response => response.json())
      .then(data => {
        if (data.status === 'followed') {
          btn.textContent = 'ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤';
        } else if (data.status === 'unfollowed') {
          btn.textContent = 'ãƒ•ã‚©ãƒ­ãƒ¼';
        }
      });
    });
  }
});
</script>


  <hr>

  <h3>ğŸ“ {{ profile_user.username }} ã®æŠ•ç¨¿</h3>
  {% for tweet in tweets %}
    <p>{{ tweet.content }}<br><small>{{ tweet.created_at }}</small></p>
  {% empty %}
    <p>ã¾ã æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  {% endfor %}
{% endblock %}
